this.Promise=function(){"use strict";let e,t=0;function r(e,r){l[t]=e,l[t+1]=r,t+=2,2===t&&f()}const n="undefined"!=typeof window?window:void 0,s=n||{},o=s.MutationObserver||s.WebKitMutationObserver,i="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function u(){const e=setTimeout;return()=>e(a,0)}const l=new Array(1e3);function a(){for(let e=0;e<t;e+=2){(0,l[e])(l[e+1]),l[e]=void 0,l[e+1]=void 0}t=0}let f;f=i?()=>process.nextTick(a):o?function(){let e=0;const t=new o(a),r=document.createTextNode("");return t.observe(r,{characterData:!0}),()=>{r.data=e=++e%2}}():c?function(){const e=new MessageChannel;return e.port1.onmessage=a,()=>e.port2.postMessage(0)}():void 0===n&&"function"==typeof require?function(){try{const t=Function("return this")().require("vertx");return e=t.runOnLoop||t.runOnContext,void 0!==e?function(){e(a)}:u()}catch(e){return u()}}():u();const h=void 0;function p(){}function y(){return new TypeError("You must pass an array.")}function d(e,t){if(e===t)v(e,new TypeError("You cannot resolve a promise with itself"));else if(function(e){let t=typeof e;return null!==e&&("object"===t||"function"===t)}(t)){let n;try{n=t.then}catch(t){return void v(e,t)}!function(e,t,n){"function"==typeof n?r((e=>{let r=!1,s=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(n,t,(n=>{r||(r=!0,t!==n?d(e,n):w(e,n))}),(t=>{r||(r=!0,v(e,t))}),e._label);!r&&s&&(r=!0,v(e,s))}),e):w(e,t)}(e,t,n)}else w(e,t)}function w(e,t){e._state===h&&(e._result=t,e._state=1,0!==e._subscribers.length&&r(g,e))}function v(e,t){e._state===h&&(e._state=2,e._result=t,r(g,e))}function g(e){let t=e._subscribers,r=e._state;if(0===t.length)return;let n,s,o=e._result;for(let e=0;e<t.length;e+=3)n=t[e],s=t[e+r],n?_(r,n,s,o):s(o);e._subscribers.length=0}function _(e,t,r,n){let s,o,i="function"==typeof r,c=!0;if(i){try{s=r(n)}catch(e){c=!1,o=e}if(t===s)return void v(t,new TypeError("A promises callback cannot return that same promise."))}else s=n;t._state!==h||(i&&c?d(t,s):!1===c?v(t,o):1===e?w(t,s):2===e&&v(t,s))}class b{constructor(e){if("function"!=typeof e)throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");this._result=this._state=void 0,this._subscribers=[];try{e((e=>{d(this,e)}),(e=>{v(this,e)}))}catch(e){v(this,e)}}then(e,t){const n=this,s=new this.constructor(p),{_state:o}=n;if(o){const e=arguments[o-1];r((()=>_(o,s,e,n._result)))}else!function(e,t,n,s){let{_subscribers:o}=e,{length:i}=o;o[i]=t,o[i+1]=n,o[i+2]=s,0===i&&e._state&&r(g,e)}(n,s,e,t);return s}catch(e){return this.then(null,e)}finally(e){return this.then((t=>b.resolve(e()).then((()=>t))),(t=>b.resolve(e()).then((()=>{throw t}))))}static resolve(e){if(e&&"object"==typeof e&&e.constructor===this)return e;let t=new this(p);return d(t,e),t}static reject(e){let t=new this(p);return v(t,e),t}static all(e){let t=this;if(Array.isArray(e)){const r=e.length;let n=new Array(r),s=0;return new t(((t,o)=>{if(0===r)t(n);else for(let i=0;i<r;i++)this.resolve(e[i]).then((function(e){s++,n[i]=e,s===r&&t(n)}),o)}))}return new t(((e,t)=>t(y())))}static race(e){let t=this;return Array.isArray(e)?new t(((r,n)=>{let s=e.length;for(let o=0;o<s;o++)t.resolve(e[o]).then(r,n)})):new t(((e,t)=>t(y())))}static any(e){let t=this;if(Array.isArray(e)){const r=e.length;let n=0;return new t(((t,s)=>{if(0===r)s(new AggregateError("All promises were rejected"));else for(let o=0;o<r;o++)this.resolve(e[o]).then(t,(()=>{n++,n===r&&s(new AggregateError("All promises were rejected"))}))}))}return new t(((e,t)=>t(y())))}static allSettled(e){let t=this;if(Array.isArray(e)){const r=e.length;let n=new Array(r),s=0;return new t(((t,o)=>{if(0===r)t(n);else for(let i=0;i<r;i++){let c=function(e,t){s++,n[i]=e,s===r&&t(n)};this.resolve(e[i]).then((e=>c({value:e,status:"fulfilled"},t)),(e=>c({reason:e,status:"rejected"},o)))}}))}return new t(((e,t)=>t(y())))}}return b.deferred=function(){let e={};return e.promise=new b((function(t,r){e.resolve=t,e.reject=r})),e},b}();
